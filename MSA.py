import numpy as np
from scipy.interpolate import interp1d

def get_atm_params(H):
    '''
    Расчет параметров стандартной атмосферы
        Аргументы:
            - H (float) - геометрическая высота [0 м...13000 м]
        
        Результат:
            - parametrs (dict):
                {'T': (float) - статическая температура, К,
                 'p': (float) - статическое давление, Па,
                 'rho': (float) - плотность воздуха, кг/м^3,
                 'a': (float) - скорость звука в воздухе, м/с}
    '''

    atm_param_data = np.array([[0, 288.150, 101325, 1.22500, 340.294],
    [250, 286.525, 98357.6, 1.19587, 339.333],
    [500, 284.900, 95461.3, 1.16727, 338.370],
    [750, 283.276, 92634.6, 1.13921, 337.403],
    [1000, 281.651, 89876.3, 1.11166, 336.435],
    [1500, 278.402, 84559.7, 1.05810, 334.489],
    [2000, 275.154, 79501.4, 1.00655, 332.532],
    [2500, 271.906, 74692.7, 0.956954, 330.563],
    [3000, 268.659, 70121.2, 0.909254, 328.584],
    [3500, 265.413, 65780.4, 0.863402, 326.592],
    [4000, 262.166, 61660.4, 0.819347, 324.589],
    [4500, 258.921, 57752.6, 0.777038, 322.573],
    [5000, 255.676, 54048.3, 0.736429, 320.545],
    [5500, 252.431, 50539.8, 0.697469, 318.505],
    [6000, 249.187, 47217.6, 0.660111, 316.452],
    [6500, 245.943, 44075.5, 0.624310, 314.385],
    [7000, 242.700, 41105.3, 0.590018, 312.306],
    [7500, 239.457, 38299.7, 0.557192, 310.212],
    [8000, 236.215, 35651.6, 0.525786, 308.105],
    [8500, 232.974, 33154.2, 0.495757, 305.984],
    [9000, 229.733, 30800.7, 0.467063, 303.848],
    [9500, 226.492, 28584.7, 0.439661, 301.697],
    [10000, 223.252, 26499.9, 0.413510, 299.532],
    [10500, 220.013, 24540.2, 0.388570, 297.351],
    [11000, 216.650, 22699.9, 0.364801, 295.154],
    [11500, 216.650, 20984.7, 0.337439, 295.069],
    [12000, 216.650, 19399.4, 0.311937, 295.069],
    [12500, 216.650, 17934.0, 0.288375, 295.069],
    [13000, 216.650, 16579.6, 0.266595, 295.069]])
    if H<0:
        if H<-1000:
            H = atm_param_data[:,0][0] 
        else:
            H = atm_param_data[:,0][0]    
    if H > atm_param_data[:,0][-1]:
        H = atm_param_data[:,0][-1]
    T_atm = interp1d(atm_param_data[:,0], atm_param_data[:,1])
    p_atm = interp1d(atm_param_data[:,0], atm_param_data[:,2])
    rho_atm = interp1d(atm_param_data[:,0], atm_param_data[:,3])
    a_atm = interp1d(atm_param_data[:,0], atm_param_data[:,4])
    parametrs = {'T': T_atm(H),
                 'p': p_atm(H),
                 'rho': rho_atm(H),
                 'a': a_atm(H)}
    return parametrs